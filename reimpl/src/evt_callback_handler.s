/* evt_callback_handler -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06041826 - 0x0604188C
 * Auto-generated by tools/generate_l3_tu.py
 *
 * Event callback dispatcher — routes an event channel index (0-7) to the
 * appropriate handler function via a switch/case on r4.
 *
 * Entry: evt_callback_handler(r4 = event_index, r5 = state_buffer_ptr)
 *   r4: event channel index (0-7), selects which handler to tail-call
 *   r5: pointer to AI/game state buffer, passed through as r4 to the handler
 *
 * Dispatch table:
 *   0 -> track_road_validate       (0x060418BE) — road segment validation
 *   1 -> track_boundary_check      (0x06041AA0) — boundary-crossing state machine
 *   2 -> cmd_enqueue target        (0x06041B3C) — command enqueue handler
 *   3 -> state_transition_handler  (0x06041CC8) — state transition processing
 *   4 -> large_func_prologue       (0x06041D6C) — large function entry
 *   5 -> track_edge_validate       (0x06041EE8) — track edge validation
 *   6 -> player_vehicle_interp     (0x06042134) — vehicle interpolation queue
 *   7 -> track_shadow_validate     (0x06042088) — shadow projection validation
 *
 * Each case tail-calls the handler after restoring r14 and passing the
 * state_buffer_ptr as the handler's first argument (r4).
 *
 * Returns: whatever the dispatched handler returns, or falls through with
 *          no return value if event_index > 7.
 *
 * Secondary function: sym_06041884 (init_callback_param)
 *   Stores r4 into game_state[+0x3C] (the pending transfer counter field).
 *   Called by credits_scroll to initialize event callback parameters.
 */

    .section .text.FUN_06041826


    .global evt_callback_handler
    .type evt_callback_handler, @function
evt_callback_handler:
    mov.l r14, @-r15                        ! save r14 (callee-saved)
    mov r5, r14                             ! r14 = state_buffer_ptr (preserve across dispatch)
    bra     .L_dispatch_switch              ! jump to switch/case logic
    mov r4, r0                              ! r0 = event_index (delay slot)
.L_case_0:
    mov r14, r4                             ! r4 = state_buffer_ptr (arg for handler)
    .byte   0xA0, 0x45    /* bra 0x060418BE (external) */  ! tail-call track_road_validate
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_1:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA1, 0x33    /* bra 0x06041AA0 (external) */  ! tail-call track_boundary_check
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_2:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA1, 0x7E    /* bra 0x06041B3C (external) */  ! tail-call cmd_enqueue target
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_3:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA2, 0x41    /* bra 0x06041CC8 (external) */  ! tail-call state_transition_handler
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_4:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA2, 0x90    /* bra 0x06041D6C (external) */  ! tail-call large_func_prologue
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_5:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA3, 0x4B    /* bra 0x06041EE8 (external) */  ! tail-call track_edge_validate
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_6:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA4, 0x6E    /* bra 0x06042134 (external) */  ! tail-call player_vehicle_interp
    mov.l @r15+, r14                        ! restore r14 (delay slot)
.L_case_7:
    mov r14, r4                             ! r4 = state_buffer_ptr
    .byte   0xA4, 0x15    /* bra 0x06042088 (external) */  ! tail-call track_shadow_validate
    mov.l @r15+, r14                        ! restore r14 (delay slot)
    .2byte  0x0360                          ! padding (unreachable)
.L_dispatch_switch:
    cmp/eq #0x0, r0                         ! event_index == 0?
    bt      .L_case_0                       ! -> track_road_validate
    cmp/eq #0x1, r0                         ! event_index == 1?
    bt      .L_case_1                       ! -> track_boundary_check
    cmp/eq #0x2, r0                         ! event_index == 2?
    bt      .L_case_2                       ! -> cmd_enqueue target
    cmp/eq #0x3, r0                         ! event_index == 3?
    bt      .L_case_3                       ! -> state_transition_handler
    cmp/eq #0x4, r0                         ! event_index == 4?
    bt      .L_case_4                       ! -> large_func_prologue
    cmp/eq #0x5, r0                         ! event_index == 5?
    bt      .L_case_5                       ! -> track_edge_validate
    cmp/eq #0x6, r0                         ! event_index == 6?
    bt      .L_case_6                       ! -> player_vehicle_interp
    cmp/eq #0x7, r0                         ! event_index == 7?
    bt      .L_case_7                       ! -> track_shadow_validate
    rts                                     ! event_index > 7: return (no handler)
    mov.l @r15+, r14                        ! restore r14 (delay slot)

    .global sym_06041884
sym_06041884:
    .byte   0xD3, 0x08    /* mov.l .L_pool_060418A8, r3 */  ! r3 = &game_state_base_ptr (sym_060A5400)
    mov.l @r3, r3                           ! r3 = game_state_base (dereference pointer)
    rts                                     ! return
    mov.l r4, @(60, r3)                     ! game_state[+0x3C] = r4 (set pending transfer counter, delay slot)
