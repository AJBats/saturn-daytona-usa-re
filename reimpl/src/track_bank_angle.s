/* track_bank_angle -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06036248 - 0x060362A8
 * Auto-generated by tools/generate_l3_tu.py
 */

    .section .text.FUN_06036248


    .global track_bank_angle
    .type track_bank_angle, @function
track_bank_angle:
    sts.l pr, @-r15                     ! save return address
    mov r4, r12                         ! r12 = segment index (from arg r4)
    add #-0x10, r15                     ! allocate 16 bytes of locals
    mov r15, r4                         ! r4 = local buffer base
    mov.l   .L_fn_analog, r3           ! load input_proc_analog address
    jsr @r3                             ! call input_proc_analog
    add #0x8, r4                        ! (delay) r4 = &locals[8] (cmd buffer)
    mov r15, r2                         ! r2 = local buffer base
    mov #0x41, r3                       ! r3 = 0x41 (track query command ID)
    extu.b r12, r12                     ! zero-extend segment index to byte
    mov r15, r6                         ! r6 = &locals[0] (result buffer)
    mov r15, r5                         ! r5 = &locals[0]
    add #0x8, r2                        ! r2 = &locals[8] (cmd buffer)
    mov r12, r0                         ! r0 = segment index
    add #0x8, r5                        ! r5 = &locals[8] (cmd buffer)
    mov.b r3, @r2                       ! cmd_buf[0] = 0x41 (command byte)
    mov r15, r2                         ! r2 = local buffer base
    add #0x8, r2                        ! r2 = &locals[8]
    mov.b r0, @(4, r2)                  ! cmd_buf[4] = segment index
    mov.l   .L_fn_digital, r3          ! load input_proc_digital address
    jsr @r3                             ! call input_proc_digital
    mov #0x0, r4                        ! (delay) r4 = 0 (channel 0)
    mov r0, r4                          ! r4 = return status
    mov r15, r2                         ! r2 = local buffer base
    mov r4, r0                          ! r0 = return status (for caller)
    mov.l @r2, r3                       ! r3 = result[0] (bank angle X)
    mov.l   .L_mask_low24, r2          ! r2 = 0x00FFFFFF
    and r2, r3                          ! mask to low 24 bits
    mov.l r3, @r13                      ! store bank angle X to *r13 (output)
    mov r15, r2                         ! r2 = local buffer base
    mov.l @(4, r2), r3                  ! r3 = result[1] (bank angle Y)
    mov.l   .L_mask_low24, r2          ! r2 = 0x00FFFFFF
    and r2, r3                          ! mask to low 24 bits
    mov.l r3, @r14                      ! store bank angle Y to *r14 (output)
    add #0x10, r15                      ! deallocate 16 bytes of locals
    lds.l @r15+, pr                     ! restore return address
    mov.l @r15+, r12                    ! restore caller's r12
    mov.l @r15+, r13                    ! restore caller's r13
    rts                                 ! return
    mov.l @r15+, r14                    ! (delay) restore caller's r14
.L_fn_analog:
    .4byte  input_proc_analog
    .4byte  input_proc_buttons
.L_fn_digital:
    .4byte  input_proc_digital
.L_mask_low24:
    .4byte  0x00FFFFFF                  /* low 24-bit mask */
