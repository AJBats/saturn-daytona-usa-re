/* cd_course_loader -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06012D7C - 0x06012DB4
 * Auto-generated by tools/generate_l3_tu.py
 *
 * Loads course polygon data from CD into Work RAM Low.
 *
 * Selects the appropriate CSxPOLY.BIN file based on the course ID,
 * then tail-calls cd_dma_setup to perform the actual disc read.
 *
 * Arguments:
 *   r4 = course ID (1 = course 1, 2 = course 2, other = course 0)
 *
 * Tail-calls:
 *   cd_dma_setup(filename_ptr, wram_low_dest)
 *     r4 = pointer to filename string ("CS0POLY.BIN" / "CS1POLY.BIN" / "CS2POLY.BIN")
 *     r5 = 0x00200000 (Work RAM Low base address)
 */

    .section .text.FUN_06012D7C


    .global cd_course_loader
    .type cd_course_loader, @function
cd_course_loader:
    mov.l r14, @-r15                    ! save r14 (callee-saved)
    mov r4, r0                          ! r0 = course ID
    mov.l   .L_wram_low, r14            ! r14 = 0x00200000 (Work RAM Low base)
    cmp/eq #0x1, r0                     ! is course ID == 1?
    bf      .L_check_course2            ! if not course 1, check for course 2
    mov r14, r5                         ! r5 = DMA destination (Work RAM Low)
    mov.l   .L_pool_cs1poly_filename, r4 ! r4 = &"CS1POLY.BIN"
    .byte   0xAF, 0x57    /* bra 0x06012C3C (external) */  ! tail-call cd_dma_setup
    mov.l @r15+, r14                    ! restore r14 (delay slot)
.L_check_course2:
    mov r4, r0                          ! r0 = course ID (reload for compare)
    cmp/eq #0x2, r0                     ! is course ID == 2?
    bf      .L_default_course0          ! if not course 2, fall through to default (course 0)
    mov r14, r5                         ! r5 = DMA destination (Work RAM Low)
    mov.l   .L_pool_cs2poly_filename, r4 ! r4 = &"CS2POLY.BIN"
    .byte   0xAF, 0x50    /* bra 0x06012C3C (external) */  ! tail-call cd_dma_setup
    mov.l @r15+, r14                    ! restore r14 (delay slot)
.L_default_course0:
    mov r14, r5                         ! r5 = DMA destination (Work RAM Low)
    mov.l   .L_pool_cs0poly_filename, r4 ! r4 = &"CS0POLY.BIN"
    .byte   0xAF, 0x4C    /* bra 0x06012C3C (external) */  ! tail-call cd_dma_setup
    mov.l @r15+, r14                    ! restore r14 (delay slot)
.L_wram_low:
    .4byte  0x00200000                  /* Work RAM Low base */
.L_pool_cs1poly_filename:
    .4byte  sym_060448E8                /* -> "CS1POLY.BIN" */
.L_pool_cs2poly_filename:
    .4byte  sym_060448F4                /* -> "CS2POLY.BIN" */
.L_pool_cs0poly_filename:
    .4byte  sym_06044900                /* -> "CS0POLY.BIN" */
