/* smpc_cmd_helper_c -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06035C80 - 0x06035CBC
 * Auto-generated by tools/generate_l3_tu.py
 *
 * Function catalog:
 *   smpc_cmd_helper_c  -- Clears CD HIRQ bits in hardware and resets
 *                         the cached HIRQ status word to zero.
 *   hirq_status_set    -- ORs new bits into the HIRQ status cache.
 *                         Called from ai_master_update / game_update_loop
 *                         with peripheral port masks before INTBACK.
 */

    .section .text.FUN_06035C80


    .global smpc_cmd_helper_c
    .type smpc_cmd_helper_c, @function
smpc_cmd_helper_c:
    sts.l pr, @-r15                         ! save return address
    mov.w   .L_const_hirq_clear_mask, r4    ! r4 = 0x0BE1 — HIRQ bits to clear
    .byte   0xBF, 0xF3    /* bsr sym_06035C6E (hirq_write: writes r4 to CD HIRQ register) */
    nop                                     ! (delay slot)
    mov #0x0, r2                            ! r2 = 0 — will zero the cache
    mov.l   .L_ptr_hirq_status_cache, r3    ! r3 -> HIRQ status cache word (sym_06063590)
    lds.l @r15+, pr                         ! restore return address
    rts                                     ! return to caller
    mov.w r2, @r3                           ! (delay slot) clear HIRQ status cache to 0

    .global sym_06035C92
sym_06035C92:
    extu.w r4, r4                           ! zero-extend mask to 16 bits
    mov.l   .L_ptr_hirq_status_cache, r3    ! r3 -> HIRQ status cache (for read)
    mov.l   .L_ptr_hirq_status_cache, r2    ! r2 -> HIRQ status cache (for write-back)
    mov.w @r3, r3                           ! r3 = current cached HIRQ status
    or r4, r3                               ! merge new bits into cache
    rts                                     ! return to caller
    mov.w r3, @r2                           ! (delay slot) write updated cache
    .4byte  0xD002000B
    .2byte  0x6001
.L_const_hirq_clear_mask:
    .2byte  0x0BE1                          /* [HIGH] HIRQ clear mask — bits 0,5-7,9-11 of CD HIRQ */
.L_ptr_hirq_status_cache:
    .4byte  sym_06063590                    /* [HIGH] HIRQ status cache word in WRAM — also used by smpc_peripheral_query, smpc_cmd_helper_b */
    .4byte  0x2589000C
    .4byte  0xD30A000B
    .4byte  0x2341D00A
    .4byte  0x000B0009
