/* vdp2_course2_init -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06003508 - 0x06003578
 * Auto-generated by tools/generate_l3_tu.py
 *
 * Initializes VDP2 resources for course 2 (Dinosaur Canyon).
 * Copies palette data to color RAM, then DMA-transfers three
 * blocks of tile/pattern data into VDP2 VRAM.
 */

    .section .text.FUN_06003508


    .global vdp2_course2_init
    .type vdp2_course2_init, @function
vdp2_course2_init:
    mov.l r14, @-r15                        ! save r14 on stack (callee-save)
    sts.l pr, @-r15                         ! save return address on stack
    mov.w   .L_wpool_06003540, r6           ! r6 = 0x0100 = 256 words to copy
    mov.l   .L_vdp2_cram_0x940, r5         ! r5 = 0x25F00940 — palette source in CRAM
    mov.l   .L_vdp2_cram_0x200, r4         ! r4 = 0x25F00200 — palette dest in CRAM
    mov.l   .L_fn_memcpy_word_idx, r3      ! r3 = &memcpy_word_idx
    jsr @r3                                 ! call memcpy_word_idx(dest, src, count)
    nop                                     ! delay slot (nop)
    mov.l   .L_fn_dma_memory_transfer, r14 ! r14 = &dma_memory_transfer (reused for 3 calls)
    mov.l   .L_vdp2_vram_0x34000, r5       ! r5 = 0x25E34000 — VRAM dest for bg tile data
    mov.l   .L_vdp2_vram_0x4EFEC, r4       ! r4 = 0x25E4EFEC — VRAM source for bg tile data
    jsr @r14                                ! call dma_memory_transfer(src, dest) — bg tiles
    nop                                     ! delay slot (nop)
    mov.l   .L_ptr_course2_tile_data, r5   ! r5 = &sym_060612AC (pointer to tile data address)
    mov.l   .L_vdp2_vram_0x42300, r4       ! r4 = 0x25E42300 — VRAM dest for pattern data
    jsr @r14                                ! call dma_memory_transfer(src, dest) — pattern block 1
    mov.l @r5, r5                           ! delay slot: r5 = *sym_060612AC (load actual src addr)
    mov.l   .L_ptr_course2_tile_data, r5   ! r5 = &sym_060612AC (reload pointer)
    mov.w   .L_wpool_0600353E, r2           ! r2 = 0x2000 = offset to second pattern block
    mov.l   .L_vdp2_vram_0x42C78, r4       ! r4 = 0x25E42C78 — VRAM dest for pattern data block 2
    mov.l @r5, r5                           ! r5 = *sym_060612AC (load actual src addr again)
    jsr @r14                                ! call dma_memory_transfer(src, dest) — pattern block 2
    add r2, r5                              ! delay slot: r5 += 0x2000 (offset into second block)
    lds.l @r15+, pr                         ! restore return address from stack
    rts                                     ! return to caller
    mov.l @r15+, r14                        ! delay slot: restore r14 from stack
    .2byte  0x00E0                          ! alignment padding
.L_wpool_0600353E:
    .2byte  0x2000                          ! word pool: 0x2000 = pattern block 2 offset
.L_wpool_06003540:
    .2byte  0x0100                          ! word pool: 0x0100 = 256 words to copy
    .2byte  0xFFFF                          ! alignment padding
    .4byte  0x25F00860                      ! (unused pool entry — VDP2 CRAM +0x860)
.L_vdp2_cram_0x200:
    .4byte  0x25F00200                      /* VDP2 color RAM +0x200 — palette dest */
.L_fn_memcpy_word_idx:
    .4byte  memcpy_word_idx                 /* word-indexed memory copy function */
.L_fn_dma_memory_transfer:
    .4byte  dma_memory_transfer             /* DMA block transfer function */
.L_vdp2_vram_0x34000:
    .4byte  0x25E34000                      /* VDP2 VRAM +0x34000 — bg tile dest */
    .4byte  0x25E497E4                      /* (unused pool entry — VDP2 VRAM +0x497E4) */
.L_ptr_course2_tile_data:
    .4byte  sym_060612AC                    /* pointer to course 2 tile/pattern source data */
    .4byte  0x25E4108C                      /* (unused pool entry — VDP2 VRAM +0x4108C) */
    .4byte  0x25E41A24                      /* (unused pool entry — VDP2 VRAM +0x41A24) */
.L_vdp2_cram_0x940:
    .4byte  0x25F00940                      /* VDP2 color RAM +0x940 — palette source */
.L_vdp2_vram_0x4EFEC:
    .4byte  0x25E4EFEC                      /* VDP2 VRAM +0x4EFEC — bg tile source */
.L_vdp2_vram_0x42300:
    .4byte  0x25E42300                      /* VDP2 VRAM +0x42300 — pattern dest block 1 */
.L_vdp2_vram_0x42C78:
    .4byte  0x25E42C78                      /* VDP2 VRAM +0x42C78 — pattern dest block 2 */
