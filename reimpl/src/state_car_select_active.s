/* VERIFIED: active during car select screen (called after mode select C press)
 * Method: call-trace differential — 10 frames idle vs 10 frames with C on mode select
 *   12 calls during C (baseline 10, +2) — runs every frame during car select state
 *   Not present in idle mode select frames, appears only after transition
 * Date: 2026-02-28
 */
/* state_car_select_active -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06008B9C - 0x06008BD8
 * Auto-generated by tools/generate_l3_tu.py
 *
 * Car selection screen per-frame handler.
 * Called every frame while the car selection menu is displayed.
 * Entered after state_car_select_init (state 8) completes initialization.
 *
 * Per-frame logic:
 *   1. Call car_select_input() — process D-pad and confirm button
 *   2. Call track_seg_phys_init() — update display lists and physics
 *   3. Call camera_finalize() — commit camera state for this frame
 *   4. Clear animation_state = 0
 *
 * Global references:
 *   sym_0605AD10 = game_state_dispatch (32-bit)
 *   sym_06026CE0 = camera_finalize()
 *   sym_06059F44 = animation_state (32-bit)
 *   sym_0605A016 = display_mode (16-bit)
 */

    .section .text.FUN_06008B9C


    .global state_car_select_active
    .type state_car_select_active, @function
state_car_select_active:
    sts.l pr, @-r15                             ! save return address
    mov.l   .L_pool_fn_car_select_input, r3     ! r3 = &car_select_input
    jsr @r3                                     ! car_select_input() — process player input
    nop                                         ! (delay slot)
    mov.l   .L_pool_fn_track_seg_phys_init, r3  ! r3 = &track_seg_phys_init
    jsr @r3                                     ! track_seg_phys_init() — update display lists and physics
    nop                                         ! (delay slot)
    mov.l   .L_pool_fn_camera_finalize, r3      ! r3 = &camera_finalize
    jsr @r3                                     ! camera_finalize() — commit camera state
    nop                                         ! (delay slot)
    mov #0x0, r2                                ! r2 = 0
    mov.l   .L_pool_anim_state_ptr, r3          ! r3 = &animation_state
    lds.l @r15+, pr                             ! restore return address
    rts                                         ! return to caller
    mov.l r2, @r3                               ! (delay slot) animation_state = 0
    .2byte  0xFFFF                              ! padding
    .4byte  sym_0605AD10                        ! game_state_dispatch (32-bit)
    .4byte  car_select_setup                    ! car_select_setup entry point
.L_pool_fn_camera_finalize:
    .4byte  sym_06026CE0                        ! camera_finalize()
.L_pool_anim_state_ptr:
    .4byte  sym_06059F44                        ! animation_state (32-bit)
    .4byte  sym_0605A016                        ! display_mode (16-bit)
.L_pool_fn_car_select_input:
    .4byte  car_select_input                    ! car_select_input()
.L_pool_fn_track_seg_phys_init:
    .4byte  track_seg_phys_init                 ! track_seg_phys_init()
