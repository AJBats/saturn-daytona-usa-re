/* results_scroll_anim -- L3 assembly (SH-2 mnemonics)
 * Translation unit: 0x06016230 - 0x06016298
 * Auto-generated by tools/generate_l3_tu.py
 */

    .section .text.FUN_06016230


    .global results_scroll_anim
    .type results_scroll_anim, @function
results_scroll_anim:
    sts.l pr, @-r15                       ! save return address
    extu.b r4, r13                        ! r13 = scroll_table_index (zero-extend byte)
    shll2 r14                             ! r14 = entry_group * 4
    shll2 r3                              ! r3 = entry_offset * 4
    add #-0x4, r15                        ! allocate 4 bytes on stack
    shll2 r13                             ! r13 = scroll_table_index * 4
    shll2 r3                              ! r3 = entry_offset * 16
    mov.l   .L_pool_slot_data_base, r2    ! r2 = &slot_data_array
    shll2 r3                              ! r3 = entry_offset * 64
    add r3, r14                           ! r14 = (entry_group * 4) + (entry_offset * 64)
    exts.w r14, r14                       ! sign-extend slot offset to 32 bits
    mov #0x0, r3                          ! r3 = 0
    add r2, r14                           ! r14 = &slot_data_array + offset â†’ slot pointer
    mov.l r3, @(44, r14)                  ! slot[44] = 0 (clear scroll delta)
    shll r13                              ! r13 = scroll_table_index * 8 (table entry size)
    mov.l   .L_pool_scroll_pos_table, r3  ! r3 = &scroll_position_table
    add r3, r13                           ! r13 = &scroll_position_table[index]
    mov.w @r13, r2                        ! r2 = scroll_x (signed 16-bit)
    shll16 r2                             ! r2 = scroll_x << 16 (fixed-point)
    mov.l r2, @(52, r14)                  ! slot[52] = scroll_x in fixed-point
    mov r13, r3                           ! r3 = &table_entry
    add #0x2, r3                          ! r3 = &table_entry + 2 (scroll_y field)
    mov.l r3, @r15                        ! save &scroll_y on stack
    mov.w @r3, r2                         ! r2 = scroll_y (signed 16-bit)
    shll16 r2                             ! r2 = scroll_y << 16 (fixed-point)
    mov.l r2, @(16, r14)                  ! slot[16] = scroll_y in fixed-point
    mov.l @r15, r4                        ! r4 = &scroll_y (restore from stack)
    mov.l   .L_pool_abs_diff_fn, r3       ! r3 = &abs_diff function
    jsr @r3                               ! call abs_diff(scroll_speed)
    mov.w @r4, r4                         ! r4 = scroll_speed value (delay slot)
    shll16 r0                             ! r0 = abs_diff result << 16 (fixed-point)
    mov.l r0, @(36, r14)                  ! slot[36] = scroll speed magnitude
    mov.w @(6, r13), r0                   ! r0 = table_entry[6] (scroll_z, 16-bit)
    mov r0, r2                            ! r2 = scroll_z
    shll16 r2                             ! r2 = scroll_z << 16 (fixed-point)
    mov.l r2, @(32, r14)                  ! slot[32] = scroll_z in fixed-point
    mov.b @(2, r14), r0                   ! r0 = slot[2] (anim frame counter)
    mov r0, r3                            ! r3 = frame counter
    add #0x1, r3                          ! r3 = frame counter + 1
    mov r3, r0                            ! r0 = incremented counter
    mov.b r0, @(2, r14)                   ! slot[2] = frame counter + 1
    add #0x4, r15                         ! deallocate stack space
    lds.l @r15+, pr                       ! restore return address
    mov.l @r15+, r13                      ! restore r13
    rts                                   ! return
    mov.l @r15+, r14                      ! restore r14 (delay slot)
.L_pool_slot_data_base:
    .4byte  sym_06084FC8
.L_pool_scroll_pos_table:
    .4byte  sym_0605BAB8
.L_pool_abs_diff_fn:
    .4byte  sym_06035438
